<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Batman1788 Menu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bat-black: #18191b;
      --bat-card: #232427;
      --bat-gold: #ffe02e;
      --bat-yellow: #ffdf2b;
      --bat-gray: #eee;
    }
    body {
      margin: 0; background: var(--bat-black); color: #fff;
      font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', Arial, sans-serif;
    }
    .header {
      padding: 28px 0 10px 0; text-align: center;
      font-size: 2.1em; font-weight: 800; letter-spacing: 2px;
      background: var(--bat-black);
      color: var(--bat-gold);
      text-shadow: 0 2px 24px #000, 0 1px 0 #fff3;
      position: sticky; top: 0; z-index: 9;
      border-bottom: 1.5px solid #2c2c2e;
    }
    .header .bat-logo {
      font-size: 1.4em;
      vertical-align: middle;
      margin-right: 9px;
      filter: drop-shadow(0 2px 4px #ffe02e55);
    }
    .marquee-wrap {
      background: #2a2927;
      border-bottom: 1.2px solid #282828;
      overflow: hidden; position: relative; height: 38px;
    }
    .marquee-text {
      color: var(--bat-gold);
      font-size: 1.03em; font-weight: 600; line-height:38px;
      white-space: nowrap;
      position: absolute; left:100%; top:0;
      will-change: transform;
      text-shadow:0 1px 10px #0006;
    }
    .menu-wrap { max-width: 530px; margin: 0 auto; padding: 18px 0 70px 0;}
    .menu-item {
      display: flex; background: var(--bat-card); border-radius: 18px;
      box-shadow: 0 3px 14px #ffe02e1b, 0 0 0 1.6px #ffe02e33;
      margin:0 12px 18px 12px; padding: 13px 12px; align-items: flex-start;
      border: 1.2px solid var(--bat-gold);
      transition:.15s;
    }
    .menu-img {
      width: 68px; height: 68px; border-radius: 13px; object-fit: cover;
      background: #252323; margin-right: 13px; border: 1.3px solid var(--bat-gold);
      box-shadow:0 2px 10px #ffe02e3a;
      flex-shrink: 0;
    }
    .menu-info { flex:1; min-width: 0;}
    .menu-name {
      font-size: 1.12em; font-weight: 700; margin-bottom: 2.5px;
      color: var(--bat-gold); display: flex; align-items:center;
      text-shadow: 0 2px 7px #ffe02e1a, 0 0px 1px #000;
    }
    .menu-badge {
      display: inline-block; background: linear-gradient(90deg, #ffe02e, #ffc400);
      color: #111; border-radius: 9px; font-size: .83em; font-weight: 600;
      padding: 2px 9px 2px 9px; margin-left: 7px; margin-right: 4px; letter-spacing: 1px;
      box-shadow:0 1px 5px #ffe02e44;
    }
    .menu-type {
      display:inline-block; background: #303030; color:var(--bat-gold);
      font-size:.8em; border-radius:7px; padding:2px 8px; margin-left:6px;
      border:1px solid #ffe02e2c;
    }
    .menu-title { color:var(--bat-gold); font-size:.95em; margin-bottom:1px; margin-right:4px;}
    .menu-thccbd { color:#ffe02e; font-size:0.97em; font-weight:500; margin-bottom:2px; margin-right:10px;}
    .menu-specs { margin:5px 0 0 0; display: flex; gap:11px; flex-wrap: wrap;}
    .menu-spec { background: #2d2c22; color:var(--bat-gold); font-size:1.01em; border-radius:7px;
      padding:2px 11px; margin-right:2px; display:inline-block;
      border:1.1px solid #ffe02e;
      box-shadow:0 1px 6px #ffe02e22;}
    .menu-price { color: #ffe02e; font-weight: 800; font-size:1.08em; margin-left:4px;}
    .menu-desc { font-size:.97em; color:#f8f6c7; margin:7px 0 0 0; line-height:1.48; text-shadow:0 1px 4px #1a17084f;}
    .footer { position:fixed; left:0; bottom:0; width:100vw; color:#ffc400; background:#18191b;
      font-size:.98em; text-align:center; padding:12px 0 9px 0; z-index:22; border-top: 1.5px solid #2c2c2e;}
    a { color: #ffe02e; text-decoration:underline; }
    @media (max-width:530px) {
      .menu-wrap { padding: 5px 0 63px 0;}
      .menu-item { margin: 0 3vw 15px 3vw; padding: 10px 5px;}
      .menu-img { width:54px; height:54px; margin-right:7px;}
      .menu-name { font-size: 1em;}
    }
    @media (max-width:400px){
      .menu-item { flex-direction: column; align-items: stretch;}
      .menu-img { margin: 0 0 10px 0; }
    }
  </style>
</head>
<body>
  <div class="header">
    <span class="bat-logo">ü¶á</span> Batman1788
  </div>
  <div class="marquee-wrap">
    <div class="marquee-inner" style="white-space:nowrap;display:flex;">
      <span class="marquee-text" id="marqueeText"></span>
      <span class="marquee-text" id="marqueeTextClone"></span>
    </div>
  </div>
  <div class="menu-wrap" id="menu"></div>
  <div class="footer">
    Batman1788 &copy; Menu | <a href="https://t.me/batman1788" target="_blank">Telegram‰∏ãÂçï</a>
  </div>
  <script>
    // ---- ‰øÆÊîπËøôÈáåÂç≥ÂèØ ----
    const SHEET_ID = "1hUlRnvEy-k2Arz8SVKpRsAaBEFTyS6RDJBDfwDmM-Hs";
    const SHEET_TAB_MENU = "batmenu";
    const SHEET_TAB_NOTICE = "notice";
    // Êé®ËçêÁî® opensheet.elk.shÔºå‰∏çÁî®API Key
    const MENU_URL = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_TAB_MENU}`;
    const NOTICE_URL = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_TAB_NOTICE}`;

    // Ë∑ëÈ©¨ÁÅØ
    fetch(NOTICE_URL)
      .then(res=>res.json())
      .then(rows=>{
        let notices = rows.map(r=>r.msg).filter(Boolean);
        let text = notices.join(" ¬†¬†|¬†¬† ");
        const marquee = document.getElementById('marqueeText');
        const clone = document.getElementById('marqueeTextClone');
        marquee.innerText = text;
        clone.innerText = text; // ÂÖãÈöÜ‰∏Ä‰ªΩ

        let wrap = marquee.parentNode;
        let speed = 1.2;  // Ë∞ÉÊï¥ÊªöÂä®ÈÄüÂ∫¶

        let pos = 0;
        function scroll() {
          pos -= speed;
          // ÊÄªÂÆΩÂ∫¶ = 2*marquee.offsetWidth
          if (Math.abs(pos) > marquee.offsetWidth) pos = 0;
          wrap.style.transform = `translateX(${pos}px)`;
          requestAnimationFrame(scroll);
        }
        setTimeout(scroll, 200);
      });

    // ËèúÂçï
    fetch(MENU_URL)
      .then(res=>res.json())
      .then(rows=>{
        const html = rows.map(obj=>{
          // Â§öËßÑÊ†º
          let specs = '';
          for(let i=1;i<=3;i++){
            if(obj['spec'+i] && obj['price'+i]){
              specs += `<span class="menu-spec">${obj['spec'+i]}<span class="menu-price">${obj['price'+i]}</span></span>`;
            }
          }
          // THC/CBDÂêàÊàê
          let thccbd = obj.thccbd || '';
          if(!thccbd && (obj.thc || obj.cbd)) thccbd = (obj.thc?obj.thc:'')+(obj.cbd?(' / '+obj.cbd):'');
          return `
            <div class="menu-item">
              ${obj.img ? `<img class="menu-img" src="${obj.img}" loading="lazy"/>` : ""}
              <div class="menu-info">
                <div class="menu-name">
                  ${obj.name || ""}
                  ${obj.badge ? `<span class="menu-badge">${obj.badge}</span>` : ""}
                  ${obj.type ? `<span class="menu-type">${obj.type}</span>` : ""}
                </div>
                <div style="display:flex;align-items:center;gap:9px;margin-bottom:2px;">
                  ${obj.title ? `<span class="menu-title">${obj.title}</span>` : ""}
                  ${thccbd ? `<span class="menu-thccbd">THC/CBD: ${thccbd}</span>` : ""}
                </div>
                <div class="menu-specs">${specs}</div>
                ${obj.desc ? `<div class="menu-desc">${obj.desc}</div>` : ""}
              </div>
            </div>
          `;
        }).join('');
        document.getElementById('menu').innerHTML = html || `<div style="text-align:center;color:#ccc;margin-top:40px;">ÊöÇÊó†ËèúÂçïÂÜÖÂÆπ</div>`;
      })
      .catch(err=>{
        document.getElementById('menu').innerHTML = "<div style='text-align:center;color:var(--bat-gold);margin-top:36vw;font-size:1.08em;'>ËèúÂçïÂä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞ÈáçËØï„ÄÇ</div>";
        console.error(err);
      });
  </script>
</body>
</html>
